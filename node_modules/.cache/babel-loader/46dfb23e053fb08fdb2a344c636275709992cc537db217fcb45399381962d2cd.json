{"ast":null,"code":"import _regeneratorRuntime from\"/Users/nmaluengnont/NiponDev/Gitex2023/govservcustomer-detail-widget-temp/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/nmaluengnont/NiponDev/Gitex2023/govservcustomer-detail-widget-temp/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/nmaluengnont/NiponDev/Gitex2023/govservcustomer-detail-widget-temp/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from\"react\";import styles from\"./Main.module.css\";import CustomerProfile from\"./CustomerProfile\";import Activity from\"./Activity\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var maxRetries=4;var Main=function Main(_ref){var customerAddress=_ref.customerAddress;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),customerInfo=_useState2[0],setCustomerInfo=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),retryCount=_useState4[0],setRetryCount=_useState4[1];useEffect(function(){var currentRetryCount=retryCount;var fetchHeaders=new Headers();fetchHeaders.append(\"Content-Type\",\"application/json\");var raw=JSON.stringify({operation:\"getProfile\",profileName:customerAddress});var requestOptions={method:\"POST\",headers:fetchHeaders,body:raw,redirect:\"follow\"};var fetchCustomerData=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response,result;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return fetch(\"https://us-central1-nipon-test-350808.cloudfunctions.net/public_getProfile_MongoDB_Services\",requestOptions);case 3:response=_context.sent;if(response.ok){_context.next=6;break;}throw new Error(\"Network response was not ok\");case 6:_context.next=8;return response.json();case 8:result=_context.sent;setCustomerInfo(result);_context.next=16;break;case 12:_context.prev=12;_context.t0=_context[\"catch\"](0);console.error(\"Error fetching data:\",_context.t0);if(currentRetryCount<maxRetries){currentRetryCount++;setRetryCount(currentRetryCount);}else{console.error(\"Max retries exceeded, Unable to fetch customer data.\");}case 16:case\"end\":return _context.stop();}},_callee,null,[[0,12]]);}));return function fetchCustomerData(){return _ref2.apply(this,arguments);};}();if(customerAddress){fetchCustomerData();}},[customerAddress,retryCount]);return/*#__PURE__*/_jsxs(_Fragment,{children:[!customerInfo&&/*#__PURE__*/_jsx(\"div\",{className:styles.mainContainer,children:/*#__PURE__*/_jsx(\"div\",{className:styles.loading,children:\"Loading Customer Information\"})}),customerInfo&&/*#__PURE__*/_jsxs(\"div\",{className:styles.mainContainer,children:[/*#__PURE__*/_jsx(CustomerProfile,{customerInfo:customerInfo}),/*#__PURE__*/_jsx(Activity,{customerInfo:customerInfo})]})]});};export default Main;","map":{"version":3,"names":["React","useState","useEffect","styles","CustomerProfile","Activity","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","maxRetries","Main","_ref","customerAddress","_useState","_useState2","_slicedToArray","customerInfo","setCustomerInfo","_useState3","_useState4","retryCount","setRetryCount","currentRetryCount","fetchHeaders","Headers","append","raw","JSON","stringify","operation","profileName","requestOptions","method","headers","body","redirect","fetchCustomerData","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","response","result","wrap","_callee$","_context","prev","next","fetch","sent","ok","Error","json","t0","console","error","stop","apply","arguments","children","className","mainContainer","loading"],"sources":["/Users/nmaluengnont/NiponDev/Gitex2023/govservcustomer-detail-widget-temp/src/components/Main.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\n\nimport styles from \"./Main.module.css\";\nimport CustomerProfile from \"./CustomerProfile\";\nimport Activity from \"./Activity\";\n\nconst maxRetries = 4;\n\nconst Main = ({ customerAddress }) => {\n  const [customerInfo, setCustomerInfo] = useState(null);\n  const [retryCount, setRetryCount] = useState(0);\n\n  useEffect(() => {\n    let currentRetryCount = retryCount;\n\n    let fetchHeaders = new Headers();\n    fetchHeaders.append(\"Content-Type\", \"application/json\");\n\n    let raw = JSON.stringify({\n      operation: \"getProfile\",\n      profileName: customerAddress,\n    });\n\n    var requestOptions = {\n      method: \"POST\",\n      headers: fetchHeaders,\n      body: raw,\n      redirect: \"follow\",\n    };\n\n    const fetchCustomerData = async () => {\n      try {\n        const response = await fetch(\n          `https://us-central1-nipon-test-350808.cloudfunctions.net/public_getProfile_MongoDB_Services`,\n          requestOptions\n        );\n        if (!response.ok) {\n          throw new Error(\"Network response was not ok\");\n        }\n        const result = await response.json();\n        setCustomerInfo(result);\n      } catch (error) {\n        console.error(\"Error fetching data:\", error);\n        if (currentRetryCount < maxRetries) {\n          currentRetryCount++;\n          setRetryCount(currentRetryCount);\n        } else {\n          console.error(\"Max retries exceeded, Unable to fetch customer data.\");\n        }\n      }\n    };\n\n    if (customerAddress) {\n      fetchCustomerData();\n    }\n  }, [customerAddress, retryCount]);\n\n  return (\n    <>\n      {!customerInfo && (\n        <div className={styles.mainContainer}>\n          <div className={styles.loading}>Loading Customer Information</div>\n        </div>\n      )}\n      {customerInfo && (\n        <div className={styles.mainContainer}>\n          <CustomerProfile customerInfo={customerInfo} />\n          <Activity customerInfo={customerInfo} />\n        </div>\n      )}\n    </>\n  );\n};\n\nexport default Main;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}